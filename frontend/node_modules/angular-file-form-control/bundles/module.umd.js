(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/forms'), require('rxjs/Observable'), require('rxjs/observable/forkJoin'), require('rxjs/operators')) :
	typeof define === 'function' && define.amd ? define(['exports', '@angular/core', '@angular/forms', 'rxjs/Observable', 'rxjs/observable/forkJoin', 'rxjs/operators'], factory) :
	(factory((global['angular-file-form-control'] = {}),global.ng.core,global.ng.forms,global.Rx,global.Rx.Observable,global.Rx.Observable.prototype));
}(this, (function (exports,core,forms,Observable,forkJoin,operators) { 'use strict';

var FileJson = /** @class */ (function () {
    function FileJson() {
    }
    return FileJson;
}());

var FileFormControlDirective = /** @class */ (function () {
    function FileFormControlDirective() {
    }
    FileFormControlDirective.prototype.onChange = function (event) {
        var _this = this;
        var files = event.target.files;
        if (!(files && files.length > 0)) {
            this.fileFormControl.setValue(undefined);
        }
        else {
            var callbackFn = function (array, file) { return array.concat([_this.transform(file)]); };
            forkJoin.forkJoin(Array.prototype.reduce.call(files, callbackFn, [])).pipe(operators.take(1)).subscribe(function (value) { return _this.fileFormControl.setValue(value); });
        }
    };
    FileFormControlDirective.prototype.transform = function (file) {
        return new Observable.Observable(function (subscriber) {
            var reader = new FileReader();
            var listener = function () { return subscriber.next({ name: file.name, type: file.type, value: reader.result }); };
            reader.addEventListener('load', listener);
            reader.readAsDataURL(file);
        }).pipe(operators.first());
    };
    return FileFormControlDirective;
}());

var FileFormControlModule = /** @class */ (function () {
    function FileFormControlModule() {
    }
    return FileFormControlModule;
}());

exports.FileFormControlModule = FileFormControlModule;
exports.FileFormControlDirective = FileFormControlDirective;
exports.FileJson = FileJson;

Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=module.umd.js.map